!function(a){var t=a(document).data("func",{});a.smartMenu=a.noop,a.fn.smartMenu=function(e,i){var n=a("body"),r={name:"",offsetX:2,offsetY:2,textLimit:6,beforeShow:a.noop,afterShow:a.noop},s=a.extend(r,i||{}),o=function(i){var n=i||e,r=i?Math.random().toString():s.name,c="",l="smart_menu_";return a.isArray(n)&&n.length&&(c='<div id="smartMenu_'+r+'" class="'+l+'box"><div class="'+l+'body"><ul class="'+l+'ul">',a.each(n,function(e,i){e&&(c=c+'<li class="'+l+'li_separate">&nbsp;</li>'),a.isArray(i)&&a.each(i,function(e,i){var n=i.text,r="",d="",h=Math.random().toString().replace(".","");if(n){n.length>s.textLimit&&(n=n.slice(0,s.textLimit)+"â€¦",d=' title="'+i.text+'"'),r=a.isArray(i.data)&&i.data.length?'<li class="'+l+'li" data-hover="true">'+o(i.data)+'<a href="javascript:" class="'+l+'a"'+d+' data-key="'+h+'"><i class="'+l+'triangle"></i>'+n+"</a></li>":'<li class="'+l+'li"><a href="javascript:" class="'+l+'a"'+d+' data-key="'+h+'">'+n+"</a></li>",c+=r;var u=t.data("func");u[h]=i.func,t.data("func",u)}})}),c+="</ul></div></div>"),c},c=function(){var e="#smartMenu_",i="smart_menu_",n=a(e+s.name);return n.size()?n:(a("body").append(o()),a(e+s.name+" a").bind("click",function(){var e=a(this).attr("data-key"),i=t.data("func")[e];return a.isFunction(i)&&i.call(t.data("trigger")),a.smartMenu.hide(),!1}),a(e+s.name+" li").each(function(){var t=a(this).attr("data-hover"),e=i+"li_hover";a(this).hover(function(){var n=a(this).siblings("."+e);n.removeClass(e).children("."+i+"box").hide(),n.children("."+i+"a").removeClass(i+"a_hover"),t&&(a(this).addClass(e).children("."+i+"box").show(),a(this).children("."+i+"a").addClass(i+"a_hover"))})}),a(e+s.name))};a(this).each(function(){this.oncontextmenu=function(e){a.isFunction(s.beforeShow)&&s.beforeShow.call(this),e=e||window.event,e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),a.smartMenu.hide();var i=t.scrollTop(),n=c();if(n)return n.css({display:"block",left:e.clientX+s.offsetX,top:e.clientY+i+s.offsetY}),t.data("target",n),t.data("trigger",this),a.isFunction(s.afterShow)&&s.afterShow.call(this),!1}}),n.data("bind")||n.bind("click",a.smartMenu.hide).data("bind",!0)},a.extend(a.smartMenu,{hide:function(){var a=t.data("target");a&&"block"===a.css("display")&&a.hide()},remove:function(){var a=t.data("target");a&&a.remove()}})}(jQuery);